{{ define "main" }}
<div class="container">
    <article class="post">
        <header class="post__header">
            <h1 class="post__title">{{ .Title }}</h1>

            <div class="post__meta">
                <time datetime="{{ .Date.Format " 2006-01-02" }}" class="post__date">
                    {{ .Date.Format "January 2, 2006" }}
                </time>

                {{ if .Params.author }}
                <span class="post__separator">‚Ä¢</span>
                <span class="post__author">{{ .Params.author }}</span>
                {{ end }}

                {{ if .ReadingTime }}
                <span class="post__separator">‚Ä¢</span>
                <span class="post__reading-time">{{ .ReadingTime }} min read</span>
                {{ end }}

                <span class="post__separator">‚Ä¢</span>
                <span class="post__word-count">{{ .WordCount }} words</span>
            </div>

            {{ if .Params.tags }}
            <div class="post__tags">
                {{ range .Params.tags }}
                <a href="{{ "/tags/" | relURL }}{{ . | urlize }}/" class="tag">{{ . }}</a>
                {{ end }}
            </div>
            {{ end }}

            {{ if .Params.categories }}
            <div class="post__categories">
                <span class="post__categories-label">Categories:</span>
                {{ range .Params.categories }}
                <a href="{{ "/categories/" | relURL }}{{ . | urlize }}/" class="category-link">{{ . }}</a>
                {{ end }}
            </div>
            {{ end }}
        </header>

        {{ if .Params.featured_image }}
        <div class="post__featured-image">
            <img src="{{ .Params.featured_image | relURL }}" alt="{{ .Params.featured_image_alt | default .Title }}"
                class="post__image">
            {{ if .Params.featured_image_caption }}
            <figcaption class="post__image-caption">{{ .Params.featured_image_caption }}</figcaption>
            {{ end }}
        </div>
        {{ end }}

        <div class="post__content">
            {{ .Content }}
        </div>

        <!-- Social Sharing -->
        <div class="post__sharing">
            <h3 class="post__sharing-title">Share this article</h3>
            <div class="social-share">
                <a href="https://twitter.com/intent/tweet?text={{ .Title | urlquery }}&url={{ .Permalink }}"
                    target="_blank" rel="noopener" class="social-share__link social-share__twitter">
                    <span class="social-share__icon">ùïè</span>
                    <span class="social-share__text">Twitter</span>
                </a>
                <a href="https://www.linkedin.com/sharing/share-offsite/?url={{ .Permalink }}" target="_blank"
                    rel="noopener" class="social-share__link social-share__linkedin">
                    <span class="social-share__icon">in</span>
                    <span class="social-share__text">LinkedIn</span>
                </a>
                <a href="https://www.facebook.com/sharer/sharer.php?u={{ .Permalink }}" target="_blank" rel="noopener"
                    class="social-share__link social-share__facebook">
                    <span class="social-share__icon">f</span>
                    <span class="social-share__text">Facebook</span>
                </a>
                <button class="social-share__link social-share__copy" onclick="copyToClipboard('{{ .Permalink }}')">
                    <span class="social-share__icon">üîó</span>
                    <span class="social-share__text">Copy Link</span>
                </button>
            </div>
        </div>

        <footer class="post__footer">
            <div class="post__navigation">
                {{ with .NextInSection }}
                <a href="{{ .Permalink }}" class="post__nav post__nav--prev">
                    <div class="post__nav-direction">‚Üê Previous</div>
                    <div class="post__nav-title">{{ .Title }}</div>
                </a>
                {{ end }}

                {{ with .PrevInSection }}
                <a href="{{ .Permalink }}" class="post__nav post__nav--next">
                    <div class="post__nav-direction">Next ‚Üí</div>
                    <div class="post__nav-title">{{ .Title }}</div>
                </a>
                {{ end }}
            </div>

            <div class="post__back">
                <a href="{{ "/posts/" | relURL }}" class="btn btn--outline">
                    ‚Üê Back to Articles
                </a>
            </div>
        </footer>
    </article>

    <!-- Related Posts -->
    {{ $related := .Site.RegularPages.Related . | first 3 }}
    {{ if $related }}
    <section class="related-posts">
        <h2 class="related-posts__title">Related Articles</h2>
        <div class="related-posts__grid">
            {{ range $related }}
            <article class="related-post">
                {{ if .Params.featured_image }}
                <div class="related-post__image">
                    <a href="{{ .Permalink }}">
                        <img src="{{ .Params.featured_image | relURL }}"
                            alt="{{ .Params.featured_image_alt | default .Title }}" class="related-post__img">
                    </a>
                </div>
                {{ end }}

                <div class="related-post__content">
                    <h3 class="related-post__title">
                        <a href="{{ .Permalink }}">{{ .Title }}</a>
                    </h3>

                    <div class="related-post__meta">
                        <time datetime="{{ .Date.Format " 2006-01-02" }}">
                            {{ .Date.Format "January 2, 2006" }}
                        </time>
                        {{ if .ReadingTime }}
                        <span class="related-post__separator">‚Ä¢</span>
                        <span class="related-post__reading-time">{{ .ReadingTime }} min read</span>
                        {{ end }}
                    </div>
                </div>
            </article>
            {{ end }}
        </div>
    </section>
    {{ end }}
</div>

<script>
    function copyToClipboard(text) {
        navigator.clipboard.writeText(text).then(function () {
            const button = event.target.closest('.social-share__copy');
            const originalText = button.querySelector('.social-share__text').textContent;
            button.querySelector('.social-share__text').textContent = 'Copied!';
            setTimeout(() => {
                button.querySelector('.social-share__text').textContent = originalText;
            }, 2000);
        });
    }
</script>
{{ end }}